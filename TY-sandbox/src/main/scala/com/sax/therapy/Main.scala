package com.sax.therapy

import java.net.InetAddress

import akka.actor.{ActorSystem, Props}
import com.sax.therapy.es._
import com.sax.therapy.models.raw.{Remove, Tweet}
import com.sax.therapy.stream.{Marshaller, TwitterStreamActor}
import org.elasticsearch.client.transport.TransportClient
import org.elasticsearch.common.settings.Settings
import org.elasticsearch.common.transport.InetSocketTransportAddress
import org.json4s.DefaultFormats
import org.json4s.native.Serialization._

/**
  * Created by therapy2 on 1/24/16.
  * Main class for stream project.
  */

object Main {
  def main(args: Array[String]): Unit = {
    implicit val formats = DefaultFormats
    val testJsons = List(
      "{\"created_at\":\"Fri Jan 29 21:46:51 +0000 2016\",\"id\":693188582970798080,\"id_str\":\"693188582970798080\",\"text\":\"I don't want no \\ud83c\\udfb6 https:\\/\\/t.co\\/ZVv3vY0or0\",\"source\":\"\\u003ca href=\\\"http:\\/\\/twitter.com\\/download\\/iphone\\\" rel=\\\"nofollow\\\"\\u003eTwitter for iPhone\\u003c\\/a\\u003e\",\"truncated\":false,\"in_reply_to_status_id\":null,\"in_reply_to_status_id_str\":null,\"in_reply_to_user_id\":null,\"in_reply_to_user_id_str\":null,\"in_reply_to_screen_name\":null,\"user\":{\"id\":502523039,\"id_str\":\"502523039\",\"name\":\"Ryan\",\"screen_name\":\"ryylor\",\"location\":\"Instagram : ryylor \",\"url\":\"http:\\/\\/ryylor.tumblr.com\",\"description\":\"The fool speaks , The wise man listens\",\"protected\":false,\"verified\":false,\"followers_count\":28409,\"friends_count\":22838,\"listed_count\":29,\"favourites_count\":31822,\"statuses_count\":59395,\"created_at\":\"Sat Feb 25 05:19:18 +0000 2012\",\"utc_offset\":-21600,\"time_zone\":\"Central Time (US & Canada)\",\"geo_enabled\":false,\"lang\":\"en\",\"contributors_enabled\":false,\"is_translator\":false,\"profile_background_color\":\"131516\",\"profile_background_image_url\":\"http:\\/\\/abs.twimg.com\\/images\\/themes\\/theme14\\/bg.gif\",\"profile_background_image_url_https\":\"https:\\/\\/abs.twimg.com\\/images\\/themes\\/theme14\\/bg.gif\",\"profile_background_tile\":true,\"profile_link_color\":\"009999\",\"profile_sidebar_border_color\":\"EEEEEE\",\"profile_sidebar_fill_color\":\"EFEFEF\",\"profile_text_color\":\"333333\",\"profile_use_background_image\":true,\"profile_image_url\":\"http:\\/\\/pbs.twimg.com\\/profile_images\\/691431244895293440\\/V5qb2ZpI_normal.jpg\",\"profile_image_url_https\":\"https:\\/\\/pbs.twimg.com\\/profile_images\\/691431244895293440\\/V5qb2ZpI_normal.jpg\",\"profile_banner_url\":\"https:\\/\\/pbs.twimg.com\\/profile_banners\\/502523039\\/1452978836\",\"default_profile\":false,\"default_profile_image\":false,\"following\":null,\"follow_request_sent\":null,\"notifications\":null},\"geo\":null,\"coordinates\":null,\"place\":null,\"contributors\":null,\"is_quote_status\":false,\"retweet_count\":0,\"favorite_count\":0,\"entities\":{\"hashtags\":[],\"urls\":[],\"user_mentions\":[],\"symbols\":[],\"media\":[{\"id\":693188575915945985,\"id_str\":\"693188575915945985\",\"indices\":[18,41],\"media_url\":\"http:\\/\\/pbs.twimg.com\\/media\\/CZ6zVk3UMAEBL1X.jpg\",\"media_url_https\":\"https:\\/\\/pbs.twimg.com\\/media\\/CZ6zVk3UMAEBL1X.jpg\",\"url\":\"https:\\/\\/t.co\\/ZVv3vY0or0\",\"display_url\":\"pic.twitter.com\\/ZVv3vY0or0\",\"expanded_url\":\"http:\\/\\/twitter.com\\/ryylor\\/status\\/693188582970798080\\/photo\\/1\",\"type\":\"photo\",\"sizes\":{\"medium\":{\"w\":575,\"h\":1024,\"resize\":\"fit\"},\"thumb\":{\"w\":150,\"h\":150,\"resize\":\"crop\"},\"small\":{\"w\":340,\"h\":605,\"resize\":\"fit\"},\"large\":{\"w\":575,\"h\":1024,\"resize\":\"fit\"}}}]},\"extended_entities\":{\"media\":[{\"id\":693188575915945985,\"id_str\":\"693188575915945985\",\"indices\":[18,41],\"media_url\":\"http:\\/\\/pbs.twimg.com\\/media\\/CZ6zVk3UMAEBL1X.jpg\",\"media_url_https\":\"https:\\/\\/pbs.twimg.com\\/media\\/CZ6zVk3UMAEBL1X.jpg\",\"url\":\"https:\\/\\/t.co\\/ZVv3vY0or0\",\"display_url\":\"pic.twitter.com\\/ZVv3vY0or0\",\"expanded_url\":\"http:\\/\\/twitter.com\\/ryylor\\/status\\/693188582970798080\\/photo\\/1\",\"type\":\"photo\",\"sizes\":{\"medium\":{\"w\":575,\"h\":1024,\"resize\":\"fit\"},\"thumb\":{\"w\":150,\"h\":150,\"resize\":\"crop\"},\"small\":{\"w\":340,\"h\":605,\"resize\":\"fit\"},\"large\":{\"w\":575,\"h\":1024,\"resize\":\"fit\"}}}]},\"favorited\":false,\"retweeted\":false,\"possibly_sensitive\":false,\"filter_level\":\"low\",\"lang\":\"en\",\"timestamp_ms\":\"1454104011658\"}",
      "{\"created_at\":\"Fri Jan 29 21:46:51 +0000 2016\",\"id\":693188582995963904,\"id_str\":\"693188582995963904\",\"text\":\"\\u9032\\u7814\\u26ab\\ufe0e\\\"\\u30df\\u3067\\u52c9\\u5f37\\u3057\\u305f\\u901a\\u308a\\u3060\\uff01\\u7121\\u7406\\u3084\\u308a\\u3084\\u308c\\u3070\\u30db\\u30e2\\u306b\\u306a\\u308b\\u305e\\uff01\\uff01 https:\\/\\/t.co\\/SLGgTAG6fQ\",\"source\":\"\\u003ca href=\\\"http:\\/\\/twitter.com\\/download\\/iphone\\\" rel=\\\"nofollow\\\"\\u003eTwitter for iPhone\\u003c\\/a\\u003e\",\"truncated\":false,\"in_reply_to_status_id\":null,\"in_reply_to_status_id_str\":null,\"in_reply_to_user_id\":null,\"in_reply_to_user_id_str\":null,\"in_reply_to_screen_name\":null,\"user\":{\"id\":4486878852,\"id_str\":\"4486878852\",\"name\":\"\\u307e\\u308b\\u3067\\u677e\\u30b2\\u30ce\\u30e0\",\"screen_name\":\"matsugenome\",\"location\":null,\"url\":null,\"description\":\"\\u307e\\u308b\\u3068\\u7533\\u3057\\u307e\\u3059\\u3002\\u840c\\u3048\\u306e\\u6253\\u3061\\u3063\\u653e\\u3057\\u30b4\\u30eb\\u30d5 \\u30ab\\u30e9\\u677egirl \\u6210\\u4eba\\u3067\\u3059\",\"protected\":false,\"verified\":false,\"followers_count\":711,\"friends_count\":47,\"listed_count\":19,\"favourites_count\":1268,\"statuses_count\":1281,\"created_at\":\"Mon Dec 07 14:47:59 +0000 2015\",\"utc_offset\":32400,\"time_zone\":\"Tokyo\",\"geo_enabled\":false,\"lang\":\"ja\",\"contributors_enabled\":false,\"is_translator\":false,\"profile_background_color\":\"C0DEED\",\"profile_background_image_url\":\"http:\\/\\/abs.twimg.com\\/images\\/themes\\/theme1\\/bg.png\",\"profile_background_image_url_https\":\"https:\\/\\/abs.twimg.com\\/images\\/themes\\/theme1\\/bg.png\",\"profile_background_tile\":false,\"profile_link_color\":\"0084B4\",\"profile_sidebar_border_color\":\"C0DEED\",\"profile_sidebar_fill_color\":\"DDEEF6\",\"profile_text_color\":\"333333\",\"profile_use_background_image\":true,\"profile_image_url\":\"http:\\/\\/pbs.twimg.com\\/profile_images\\/690419108215676928\\/FrsdPVjx_normal.jpg\",\"profile_image_url_https\":\"https:\\/\\/pbs.twimg.com\\/profile_images\\/690419108215676928\\/FrsdPVjx_normal.jpg\",\"profile_banner_url\":\"https:\\/\\/pbs.twimg.com\\/profile_banners\\/4486878852\\/1453537187\",\"default_profile\":true,\"default_profile_image\":false,\"following\":null,\"follow_request_sent\":null,\"notifications\":null},\"geo\":null,\"coordinates\":null,\"place\":null,\"contributors\":null,\"is_quote_status\":false,\"retweet_count\":0,\"favorite_count\":0,\"entities\":{\"hashtags\":[],\"urls\":[],\"user_mentions\":[],\"symbols\":[],\"media\":[{\"id\":693188575672700929,\"id_str\":\"693188575672700929\",\"indices\":[31,54],\"media_url\":\"http:\\/\\/pbs.twimg.com\\/media\\/CZ6zVj9UkAEesWC.jpg\",\"media_url_https\":\"https:\\/\\/pbs.twimg.com\\/media\\/CZ6zVj9UkAEesWC.jpg\",\"url\":\"https:\\/\\/t.co\\/SLGgTAG6fQ\",\"display_url\":\"pic.twitter.com\\/SLGgTAG6fQ\",\"expanded_url\":\"http:\\/\\/twitter.com\\/matsugenome\\/status\\/693188582995963904\\/photo\\/1\",\"type\":\"photo\",\"sizes\":{\"large\":{\"w\":1024,\"h\":924,\"resize\":\"fit\"},\"small\":{\"w\":340,\"h\":306,\"resize\":\"fit\"},\"thumb\":{\"w\":150,\"h\":150,\"resize\":\"crop\"},\"medium\":{\"w\":600,\"h\":541,\"resize\":\"fit\"}}}]},\"extended_entities\":{\"media\":[{\"id\":693188575672700929,\"id_str\":\"693188575672700929\",\"indices\":[31,54],\"media_url\":\"http:\\/\\/pbs.twimg.com\\/media\\/CZ6zVj9UkAEesWC.jpg\",\"media_url_https\":\"https:\\/\\/pbs.twimg.com\\/media\\/CZ6zVj9UkAEesWC.jpg\",\"url\":\"https:\\/\\/t.co\\/SLGgTAG6fQ\",\"display_url\":\"pic.twitter.com\\/SLGgTAG6fQ\",\"expanded_url\":\"http:\\/\\/twitter.com\\/matsugenome\\/status\\/693188582995963904\\/photo\\/1\",\"type\":\"photo\",\"sizes\":{\"large\":{\"w\":1024,\"h\":924,\"resize\":\"fit\"},\"small\":{\"w\":340,\"h\":306,\"resize\":\"fit\"},\"thumb\":{\"w\":150,\"h\":150,\"resize\":\"crop\"},\"medium\":{\"w\":600,\"h\":541,\"resize\":\"fit\"}}}]},\"favorited\":false,\"retweeted\":false,\"possibly_sensitive\":false,\"filter_level\":\"low\",\"lang\":\"ja\",\"timestamp_ms\":\"1454104011664\"}",
      "{\"created_at\":\"Fri Jan 29 21:46:51 +0000 2016\",\"id\":693188582991859712,\"id_str\":\"693188582991859712\",\"text\":\"@WalmartLink Et tu veux que je te boost ? T'es un dr\\u00f4le toi xD\",\"source\":\"\\u003ca href=\\\"http:\\/\\/twitter.com\\\" rel=\\\"nofollow\\\"\\u003eTwitter Web Client\\u003c\\/a\\u003e\",\"truncated\":false,\"in_reply_to_status_id\":693183631590871045,\"in_reply_to_status_id_str\":\"693183631590871045\",\"in_reply_to_user_id\":2364648744,\"in_reply_to_user_id_str\":\"2364648744\",\"in_reply_to_screen_name\":\"WalmartLink\",\"user\":{\"id\":961847732,\"id_str\":\"961847732\",\"name\":\"R\\u00e9mi RavenS L.\",\"screen_name\":\"zlRavens\",\"location\":\"Bourgogne, France\",\"url\":null,\"description\":\"CS:GO ? Easy Peasy\",\"protected\":false,\"verified\":false,\"followers_count\":53,\"friends_count\":288,\"listed_count\":2,\"favourites_count\":0,\"statuses_count\":144,\"created_at\":\"Wed Nov 21 06:03:33 +0000 2012\",\"utc_offset\":3600,\"time_zone\":\"Paris\",\"geo_enabled\":false,\"lang\":\"fr\",\"contributors_enabled\":false,\"is_translator\":false,\"profile_background_color\":\"000000\",\"profile_background_image_url\":\"http:\\/\\/abs.twimg.com\\/images\\/themes\\/theme1\\/bg.png\",\"profile_background_image_url_https\":\"https:\\/\\/abs.twimg.com\\/images\\/themes\\/theme1\\/bg.png\",\"profile_background_tile\":false,\"profile_link_color\":\"3B94D9\",\"profile_sidebar_border_color\":\"FFFFFF\",\"profile_sidebar_fill_color\":\"DDEEF6\",\"profile_text_color\":\"333333\",\"profile_use_background_image\":true,\"profile_image_url\":\"http:\\/\\/pbs.twimg.com\\/profile_images\\/692767065309122561\\/lMLfO1UO_normal.jpg\",\"profile_image_url_https\":\"https:\\/\\/pbs.twimg.com\\/profile_images\\/692767065309122561\\/lMLfO1UO_normal.jpg\",\"profile_banner_url\":\"https:\\/\\/pbs.twimg.com\\/profile_banners\\/961847732\\/1409254371\",\"default_profile\":false,\"default_profile_image\":false,\"following\":null,\"follow_request_sent\":null,\"notifications\":null},\"geo\":null,\"coordinates\":null,\"place\":null,\"contributors\":null,\"is_quote_status\":false,\"retweet_count\":0,\"favorite_count\":0,\"entities\":{\"hashtags\":[],\"urls\":[],\"user_mentions\":[{\"screen_name\":\"WalmartLink\",\"name\":\"Marre de vivre\",\"id\":2364648744,\"id_str\":\"2364648744\",\"indices\":[0,12]}],\"symbols\":[]},\"favorited\":false,\"retweeted\":false,\"filter_level\":\"low\",\"lang\":\"fr\",\"timestamp_ms\":\"1454104011663\"}"
    )
//    testJsons.foreach(testJson => {val test = read[Tweet](testJson); println(test.enrich.friends_count)})
//    val system = ActorSystem("TwitterStream")
//    val mainActor = system.actorOf(Props[TwitterStreamActor], "TwitterStreamActor")
    val system = ActorSystem("TwitterStream")
    val mainActor = system.actorOf(Props[Client], "ESClientActor")
    testJsons.foreach(testJson => mainActor ! InsertTweet(Marshaller.toTweet(testJson)))
    mainActor ! new Done()
  }
}
